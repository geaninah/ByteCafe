<!DOCTYPE html>
<html lang="en">
<head>

  <% include head_incl.ejs %>
  <title>Basket</title>

</head>
<body>

  <!-- NAVIGATION BAR -->

  <% include nav_bar.ejs %>

  <!-- END OF NAVIGATION BAR -->


  <!-- MAIN CONTENT OF THE PAGE -->

  <div class="container">
    <div class="row">

      <div class="panel panel-default">
      <!-- Default panel contents -->
        <div class="panel-heading" id="order-heading">Your order:</div>
        <div class="panel-body">
          <div class="row">
          <div class="col-sm-5">
            <p>
              Your current order includes the listed items.
              If you wish to add more items, you can always do so.
              You can also remove items that you do not want anymore.
              <br><br>
              Once you are sure this is your order, please press the
              button. You will be redirected to PayPal.
            </p>
          </div>
          <div class="col-sm-7">
            <!-- List group -->
            <ul class="list-group">
              <script> var totalPrice = 0; </script>
              <% basket.forEach(function(bask_item) { %>
                <li class="list-group-item">
                  <div class="row">
                    <div class="col-sm-7"><%= bask_item.product_name %></div>
                    <div class="col-sm-2">£&nbsp;<%= bask_item.product_price.toFixed(2); %></div>
                    <script> totalPrice = totalPrice + parseFloat(<%= bask_item.product_price %>) * parseFloat(<%= bask_item.basket_item_amount %>);</script>
                    <div class="col-sm-1"><%= bask_item.basket_item_amount %></div>
                    <div class="col-sm-1"><a href="" id="remove-button"><span class="glyphicon glyphicon-plus-sign" aria-hidden="true" style="color:#aa764e"></span></a></div>
                    <div class="col-sm-1"><a href="" id="remove-button"><span class="glyphicon glyphicon-minus-sign" aria-hidden="true" style="color:#aa764e"></span></a></div>
                </li>
              <% }); %>
             </ul>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-7">
          </div>
          <div class="col-sm-2" align="right">
            <p> Total price: </p>
          </div>
          <div class="col-sm-3">
            <p><strong> £<script>document.write(totalPrice.toFixed(2))</script></strong></p>
          </div>
      </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-8">
      </div>
      <div class="col-sm-4">
        <button type="submit" class="btn btn-default btn-block" id="goToPayment" data-toggle="modal" data-target="#AcceptPayment">Procede to payment</button>
      </div>
    </div>

    <!-- Modal -->
        <div class="modal fade" id="AcceptPayment" role="dialog">
            <div class="modal-dialog" role="document">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-body">
                  <p>Are you sure you want to complete this order and pay <strong> £<script>document.write(totalPrice)</script></strong></p>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                  <button type="button" class="btn btn-primary" data-dismiss="modal">Procede to Paypal</button>
                </div>
            </div>
            </div>
        </div>


  <!-- FOOTER OF PAGE -->

  <% include footer.ejs %>

  <!-- END OF FOOTER OF PAGE -->


</body>
</html>
